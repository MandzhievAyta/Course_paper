Monte Carlo Localization: Efﬁcient Position Estimation for Mobile Robots  Throughout the last decade, sensor-based localization has been recognized as a key problem in mobile robotics (Cox 1991; Borenstein, Everett, & Feng 1996). Localization is a version of on-line temporal state estimation, where a mobile robot seeks to estimate its position in a global coordinate frame. The localization problem comes in two ﬂavors: global localization and position tracking. The second is by far the most-studied problem; here a robot knows its initial position and “only” has to accommodate small errors in its odometry as it moves. The global localization problem involves a robot which is not told its initial position; hence, it has to solve a much more difﬁcult localization problem, that of estimating its position from scratch (this is sometimes referred to as the hijacked robot problem (Engelson 1994)). The ability to localize itself—both locally and globally—played an important role in a collection of recent mobile robot applications (Burgard et al. 1998a; Endres, Feiten, & Lawitzky 1998; Kortenkamp, Bonasso, & Murphy 1997).

While the majority of early work focused on the tracking problem, recently several researchers have developed what is now a highly successful family of approaches capable of solving both localization problems: Markov localization (Nourbakhsh, Powers, & Birchﬁeld 1995; Simmons & Koenig 1995; Kaelbling, Cassandra, & Kurien 1996; Burgard et al. 1996). The central idea of Markov localization is to represent the robot’s belief by a probability distribution over possible positions, and use Bayes rule and convolution to update the belief whenever the robot senses or moves. The idea of probabilistic state estimation goes back to Kalman ﬁlters (Gelb 1974; Smith, Self, & Cheeseman 1990), which use multivariate Gaussians to represent the robot’s belief. Because of the restrictive nature of Gaussians (they can basically represent one hypothesis only annotated by its uncertainty) Kalman-ﬁlters usually are only applied to position tracking. Markov localization employs discrete, but multi-modal representations for representing the robot’s belief, hence can solve the global localization problem. Because of the real-valued and multi-dimensional nature of kinematic state spaces these approaches can only approximate the belief, and accurate approximation usually requires prohibitive amounts of computation and memory.

In particular, grid-based methods have been developed that approximate the kinematic state space by ﬁnegrained piecewise constant functions (Burgard et al. 1996).
For reasonably-sized environments, these approaches often require memory in the excess of 100MB, and highperformance computing. At the other extreme, various researchers have resorted to coarse-grained topological representations, whose granularity is often an order of magnitude lower than that of the grid-based approach. When high resolution is needed (see e.g., (Fox et al. 1998), who uses localization to avoid collisions with static obstacles that cannot be detected by sensors), such approaches are inapplicable.

In this paper we present Monte Carlo Localization (in short: MCL). Monte Carlo methods were introduced in the Seventies (Handschin 1970), and recently rediscovered independently in the target-tracking (Gordon, Salmond, & Smith 1993), statistical (Kitagawa 1996) and computer vision literature (Isard & Blake 1998), and they have also be applied in dynamic probabilistic networks (Kanazawa, Koller, & Rus P (s j l) denote a sensor reading and the likelihood of pers Sensor readings are integrated with Bayes rule. Let P (l j a) The term l0; represents a model of the robot’s kines Bel(l) ceiving given that the robot is at position l, then is matics, whose probabilistic component accounts for errors in odometry. Following (Burgard et al. 1996), we assume odometry errors to be distributed normally.
updated according to the following rule:  sell 1995). MCL uses fast sampling techniques to represent the robot’s belief. When the robot moves or senses, importance re-sampling (Rubin 1988) is applied to estimate the posterior distribution. An adaptive sampling scheme (Koller & Fratkina 1998), which determines the number of samples on-the-ﬂy, is employed to trade-off computation and accuracy. As a result, MCL uses many samples during global localization when they are most needed, whereas the sample set size is small during tracking, when the position of the robot is approximately known.
By using a sampling-based representation, MCL has several key advantages over earlier work in the ﬁeld: 1. In contrast to existing Kalman ﬁltering based techniques, it is able to represent multi-modal distributions and thus can globally localize a robot.
2. It drastically reduces the amount of memory required compared to grid-based Markov localization and can integrate measurements at a considerably higher frequency.
3. It is more accurate than Markov localization with a ﬁxed cell size, as the state represented in the samples is not discretized.
4. It is much easier to implement.

Existing approaches to mobile robot localization can be distinguished by the way they represent the state space of the robot.
Kalman ﬁlter-based techniques. Most of the earlier approaches to robot localization apply Kalman ﬁlters (Kalman 1960). The vast majority of these approaches is based on the assumption that the uncertainty in the robot’s position can be represented by a unimodal Gaussian distribution. Sensor readings, too, are assumed to map to Gaussian-shaped distributions over the robot’s position. For these assumptions, Kalman ﬁlters provide extremely efﬁcient update rules that can be shown to be optimal (relative to the assumptions) (Maybeck 1979). Kalman ﬁlter-based techniques (Leonard & Durrant-Whyte 1992; Schiele & Crowley 1994; Gutmann & Schlegel 1996) have proven to be robust and accurate for keeping track of the robot’s position. However, since these techniques do not represent multi-modal probability distributions, which frequently occur during global localization. In practice, localization approaches using Kalman ﬁlters typically require that the starting position of the robot is known. In addition, Kalman ﬁlters rely on sensor models that generate estimates with Gaussian uncertainty— which is often unrealistic.
Topological Markov localization. To overcome these limitations, different approaches have used increasingly richer schemes to represent uncertainty, moving beyond the Gaussian density assumption inherent in the vanilla Kalman ﬁlter. These different methods can be roughly distinguished by the type of discretization used for the representation of the state space. In (Nourbakhsh, Powers, & Birchﬁeld 1995; Simmons & Koenig 1995; Kaelbling, Cassandra, & Kurien 1996), Markov localization is used for landmark-based corridor navigation and the state space is organized according  to the coarse, topological structure of the environment. The coarse resolution of the state representation limits the accuracy of the position estimates. Topological approaches typically give only a rough sense as to where the robot is.
Grid-based Markov localization. To deal with multimodal and non-Gaussian densities at a ﬁne resolution (as opposed to the coarser discretization in the above methods), grid-based approaches perform numerical integration over an evenly spaced grid of points (Burgard et al. 1996; 1998b; Fox 1998). This involves discretizing the interesting part of the state space, and use it as the basis for an approximation of the state space density, e.g. by a piece-wise constant function. Grid-based methods are powerful, but suffer from excessive computational overhead and a priori commitment to the size and resolution of the state space. In addition, the resolution and thereby also the precision at which they can represent the state has to be ﬁxed beforehand. The computational requirements have an effect on accuracy as well, as not all measurements can be processed in real-time, and valuable information about the state is thereby discarded. Recent work (Burgard et al. 1998b) has begun to address some of these problems, using oct-trees to obtain a variable resolution representation of the state space. This has the advantage of concentrating the computation and memory usage where needed, and addresses the limitations arising from ﬁxed resolutions.

Bel(l) N posterior belief by a set of weighted, random samS = j i = 1::N ples or particles fsi g. A sample set constiMCL is a version of sampling/importance re-sampling (SIR) (Rubin 1988). It is known alternatively as the bootstrap ﬁlter (Gordon, Salmond, & Smith 1993), the Monte-Carlo ﬁlter (Kitagawa 1996), the Condensation algorithm (Isard & Blake 1998), or the survival of the ﬁttest algorithm (Kanazawa, Koller, & Russell 1995). All these methods are generically known as particle ﬁlters, and a discussion of their properties can be found in (Doucet 1998).
The key idea underlying all this work is to represent the tutes a discrete approximation of a probability distribution.
Samples in MCL are of the type  hl; pi localization. More speciﬁcally, let be a sample. Then Figure 1 shows the effect of this sampling technique, starting at an initial known position (bottom center) and executing actions as indicated by the solid line. As can be seen there, the sample sets approximate distributions with increasing uncertainty, representing the gradual loss of position information due to slippage and drift.
Sensor readings are incorporated by re-weighting the sample set, in a way that implements Bayes rule in Markov  = constant that enforces PnN=1 pn 1. The incorporation of s where is the sensor measurement, and is a normalization p P (s j in which is multiplied by l), and one in which the sensor readings is typically performed in two phases, one various p-values are normalized. An algorithm to perform this re-sampling process efﬁciently in O(N) time is given in (Carpenter, Clifford, & Fernhead 1997).
In practice, we have found it useful to add a small number of uniformly distributed, random samples after each estimation step. Formally, this is legitimate because the SIR methodology (Rubin 1988) can accommodate arbitrary distributions for sampling as long as samples are weighted appropriately (using the factor p), and as long as the distribution from which samples are generated is non-zero at places where the distribution that is being approximated is nonzero—which is actually the case for MCL. The added samples are essential for relocalization in the rare event that the robot loses track of its position. Since MCL uses ﬁnite sample sets, it may happen that no sample is generated close to the correct robot position. In such cases, MCL would be unable to re-localize the robot. By adding a small number of random samples, however, MCL can effectively re-localize the robot, as documented in the experimental results section of this paper.

P (l j the weighted sample (in our case s)) (Tanner 1993).
P (l)) and the distribution that is being approximated with that the variance of the importance sampler is a function of the mismatch of the sampling distribution (in our case The less these distributions agree, the larger the variance (approximation error). The idea is here to compensate such error by larger sample set sizes, to obtain approximately uniform error.

p 1= N pler converges to zero at a rate of (under condiA nice property of the MCL algorithm is that it can universally approximate arbitrary probability distributions. As shown in (Tanner 1993), the variance of the importance samtions that are true for MCL). The sample set size naturally trades off accuracy and computational load. The true advantage, however, lies in the way MCL places computational resources. By sampling in proportion to likelihood, MCL focuses its computational resources on regions with high likelihood, where things really matter.
MCL is an online algorithm. It lends itself nicely to an any-time implementation (Dean & Boddy 1988; Zilberstein & Russell 1995). Any-time algorithms can generate an answer at any time; however, the quality of the solution increases over time. The sampling step in MCL can be terminated at any time. Thus, when a sensor reading arrives, or an action is executed, sampling is terminated and the resulting sample set is used for the next operation.

P (l) P (l j of and s), the belief before and after sensing, p each individual is large and the sample set remains small.
p sampling is stopped whenever the sum of weights (before In practice, the number of samples required to achieve a certain level of accuracy varies drastically. During global localization, the robot is completely ignorant as to where it is; hence, it’s belief uniformly covers its full three-dimensional state space. During position tracking, on the other hand, the uncertainty is typically small and often focused on lowerdimensional manifolds. Thus, many more samples are needed during global localization to accurately approximate the true density, than are needed for position tracking.
MCL determines the sample set size on-the-ﬂy. As in (Koller & Fratkina 1998), the idea is to use the divergence to determine the sample sets. More speciﬁcally, both motion data and sensor data is incorporated in a single step, and normalization!) exceeds a threshold . If the position predicted by odometry is well in tune with the sensor reading, If, however, the sensor reading carries a lot of surprise, as is typically the case when the robot is globally uncertain or when it lost track of its position, the individual p-values are small and the sample set is large.
Our approach directly relates to the well-known property  1. MCL yields signiﬁcantly more accurate localization results than the most accurate previous Markov localization algorithm, while consuming an order of magnitude less memory and computational resources. In some cases, MCL reliably localizes the robot whereas previous methods fail.
2. By and large, adaptive sampling performs equally well as MCL with ﬁxed sample sets. In scenarios involving a large range of different uncertainties (global vs. local), however, adaptive sampling is superior to ﬁxed sample sizes.
Our experiments have been carried out using several B21, B18, and Pioneer robots manufactured by ISR/RWI, shown in Figure 5. These robots are equipped with arrays of sonar sensors (from 7 to 24), one or two laser range ﬁnders, and  in the case of Minerva, shown in Figure 5, a B/W camera pointed at the ceiling. Even though all experimental results discussed here use pre-recorded data sets (to facilitate the analysis), all evaluations have been performed strictly under run-time conditions (unless explicitly noted). In fact, we have routinely ran cooperative teams of mobile robots using MCL for localization (Fox et al. 1999).

The ﬁrst series of experiments illustrates different capabilities of MCL and compares it to grid-based Markov localization, which presumably is the most accurate Markov localization technique to date (Burgard et al. 1996; 1998b; Fox 1998).

]cm 2350 SLoansaerr r[ rreo 20 on i itam 15 tse raeg 10 ev A 5 0 0 10 20 C3el0 size [4c0m] 50 60 70  30 ]cm 25 [r rreo 20 on i itam 15 tse raeg 10 ev A 5 010  Figure 6 (a) plots the localization accuracy for grid-based localization as a function of the grid resolution. These results were obtained using data recorded in the environment shown in Figure 2. They are nicely suited for our experiments because the exact same data has already been used to compare different localization approaches, including grid-based Markov localization (which was the only one that solved the global localization problem) (Gutmann et al. 1998). Notice that the results for grid-based localization shown in Figure 6 were not generated in real-time. As shown there, the accuracy increases with the resolution of the grid, both for sonar (solid line) and for laser data (dashed line). However, grid sizes below 8 cm do not permit updating in real-time, even when highly efﬁcient, selective update schemes are used (Fox, Burgard, & Thrun 1999). Results for MCL with ﬁxed sample set sizes are shown in Figure 6 (b). These results have been generated using real time conditions. Here very small sample sets are disadvantageous, since they infer too large an error in the approximation. Large sample sets are also disadvantageous, since processing them requires too much time and fewer sensor items can be processed in real-time. The “optimal” sample set size, according to Figure 6 (b), is somewhere between 1,000 and 5,000 samples. Grid-based localization, to reach the same level of accuracy, has to use grids with 4cm resolution— which is infeasible given even our best computers.

In comparison, the grid-based approach, with a resolution of 20 cm, requires almost exactly ten times as much memory when compared to MCL with 5,000 samples. During global localization, integrating a single sensor scan requires up to 120 seconds using the grid-based approach, whereas MCL consumes consistently less than 3 seconds under otherwise equal conditions. Once the robot has been localized globally, however, grid-based localization updates grid-cells selectively as described in (Burgard et al. 1998b; Fox 1998), and both approaches are about equally fast.

To test MCL in extreme situations, we evaluated it in a populated public place. During a two-week exhibition, our robot Minerva was employed as a tour-guide in the Smithsonian’s Museum of Natural History (Thrun et al. 1999). To aid localization, Minerva is equipped with a camera pointed towards the ceiling. Figure 7 shows a mosaic of the museum’s ceiling, constructed using a method described in (Thrun et al. 1999). The data used here is the most difﬁcult data set in our possession, as the robot traveled with speeds of up to 163 cm/sec. Whenever it entered or left the carpeted area in the center of the museum, it crossed a 2cm bump which introduced signiﬁcant errors in the robot’s odometry. Figure 8 shows the path measured by Minerva’s odometry.

When only using vision information, grid-based localization fails to track the robot accurately. This is because the computational overhead makes it impossible to incorporate sufﬁciently many images. MCL, however, succeeded in globally localizing the robot, and tracking the robot’s position (see also (Dellaert et al. 1999a)). Figure 9 shows the path estimated by our MCL technique. Although the localization error is sometimes above 1 meter, the system is able to keep track of multiple hypotheses and thus to recover from localization errors. The grid-based Markov localization system, however, was not able to track the whole 700m long path of the trajectory. In all our experiments, which were carried out under real-time conditions, the grid-based technique quickly lost track of the robot’s position (which, as was veriﬁed, would not be the case if the grid-based approach was given unlimited computational power). These results document that MCL is clearly superior to our previous grid-based approach.

Finally, we evaluated the utility of MCL’s adaptive approach to sampling. In particular, were were interested in determining the relative merit of the adaptive sampling scheme, if any, over a ﬁxed, static sample set (as used in some of the experiments above and in an earlier version of MCL (Dellaert et al. 1999b)). In a ﬁnal series of experiments, we applied MCL with adaptive and ﬁxed sample set sizes using data recorded with Minerva in the Smithsonian museum.
Here we use the laser range data instead of the vision data, to illustrate that MCL also works well with laser range data in environments as challenging as the one studied here.

0:01 troduced randomly, with a probability of per meter of In the ﬁrst set of experiments we tested the ability of MCL to track the robot as it moved through the museum. In this case it turned out that adaptive sampling has no signiﬁcant impact on the tracking ability of the Monte Carlo Localization. This result is not surprising since during tracking the position of the robot is concentrated on a small area.
We then evaluated the inﬂuence of adapting the sample size on the ability to globally localize the robot, and to recover from extreme localization failure. For the latter, we manually introduced severe errors into the data, to test the robustness of MCL in the extreme. In our experiments we “tele-ported” the robot at random points in time to other locations. Technically, this was done by changing the robot’s orientation by 180 90 degrees and shifting it by 200 cm, without letting the robot know. These perturbations were inrobot motion. Obviously, such incidents make the robot lose its position, and therefore are well suited to test localization  under extreme situations.
Here we found adaptive sampling to be superior to MCL with ﬁxed sample sets. Figure 10 shows the comparison.
The top curve depicts the frequency with which the error was larger than 1 meter (our tolerance threshold), for different sample set sizes. The bottom line gives the same result for the adaptive sampling approach. As is easy to be seen, adaptive sampling yields smaller error than the best MCL with ﬁxed sample set sizes. Our results have been obtained by averaging data collected along 700 meters of high-speed robot motion.

This paper presented Monte Carlo Localization (MCL), a sample-based algorithm for mobile robot localization. MCL differs from previous approaches in that it uses randomized samples (particles) to represent the robot’s belief. This leads to a variety of advantages over previous approaches: A signiﬁcant reduction in computation and memory consumption, which leads to a higher frequency at which the robot can incorporate sensor data, which in turn implies much higher accuracy. MCL is also much easier to implement than previous Markov localization approaches. Instead of having to reason about entire probability distributions, MCL randomly guesses possible positions, in a way that favors likely positions over unlikely ones. An adaptive sampling scheme was proposed that enables MCL to adjust the number of samples in proportion to the amount of surprise in the sensor data. Consequently, MCL uses few samples when tracking the robot’s position, but increases the sample set size when the robot loses track of its position, or otherwise is forced to globally localize the robot.
MCL has been tested thoroughly in practice. As our empirical results suggest, MCL beats previous Markov localization methods by an order of magnitude in memory and computation requirements, while yielding signiﬁcantly more accurate results. In some cases, MCL succeeds where gridbased Markov localization fails.
In future work, the increased efﬁciency of our samplebased localization will be applied to multi robot scenarios, where the sample sets of the different robots can be synchronized whenever one robot detects another. First experiments conducted with two robots show that the robots are able to  localize themselves much faster when combining their sample sets (Fox et al. 1999). Here, the robots were equipped with laser range-ﬁnders and cameras to detect each other.
We also plan to apply Monte Carlo methods to the problem of map acquisition, where recent work has led to new statistical frameworks that have been successfull applied to large, cyclic environments using grid representations (Thrun, Fox, & Burgard 1998).

This research is sponsored in part by NSF, DARPA via TACOM (contract number DAAE07-98-C-L032) and Rome Labs (contract number F30602-98-2-0137), and also by the EC (contract number ERBFMRX-CT96-0049) under the TMR programme.